{"ast":null,"code":"var _jsxFileName = \"E:\\\\ANURAG\\\\impact-analysis-frontend\\\\src\\\\components\\\\VideoCapture.tsx\",\n  _s = $RefreshSig$();\n/**\r\n * VideoCapture.tsx\r\n * React component for capturing video during AI interviews.\r\n * Place this file in: frontend/src/components/VideoCapture.tsx\r\n */\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\n\n// Types\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n// Resolution configurations\nconst RESOLUTIONS = {\n  '480p': {\n    width: 640,\n    height: 480\n  },\n  '720p': {\n    width: 1280,\n    height: 720\n  },\n  '1080p': {\n    width: 1920,\n    height: 1080\n  }\n};\n\n// Main Component\nconst VideoCapture = ({\n  accessToken,\n  apiBaseUrl,\n  onVideoUploaded,\n  onError,\n  onConsentChange,\n  questionId,\n  videoType = 'question_response',\n  autoStart = false,\n  showPreview = true,\n  compact = false\n}) => {\n  _s();\n  // Refs\n  const videoRef = useRef(null);\n  const mediaRecorderRef = useRef(null);\n  const streamRef = useRef(null);\n  const chunksRef = useRef([]);\n  const timerRef = useRef(null);\n\n  // State\n  const [settings, setSettings] = useState(null);\n  const [hasPermission, setHasPermission] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [recording, setRecording] = useState({\n    isRecording: false,\n    isPaused: false,\n    duration: 0,\n    blob: null\n  });\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [showConsentDialog, setShowConsentDialog] = useState(false);\n  const [consentCaptured, setConsentCaptured] = useState(false);\n\n  // Fetch video settings on mount\n  useEffect(() => {\n    fetchVideoSettings();\n    return () => {\n      stopStream();\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n    };\n  }, [accessToken]);\n\n  // Auto-start recording if enabled\n  useEffect(() => {\n    if (autoStart && settings !== null && settings !== void 0 && settings.video_enabled && consentCaptured && hasPermission) {\n      startRecording();\n    }\n  }, [autoStart, settings, consentCaptured, hasPermission]);\n  const fetchVideoSettings = async () => {\n    try {\n      const response = await fetch(`${apiBaseUrl}/api/ai-interviews/public/${accessToken}/video-settings/`);\n      if (response.ok) {\n        const data = await response.json();\n        setSettings(data);\n        setConsentCaptured(data.consent_captured);\n        if (data.video_enabled && !data.consent_captured && data.require_consent) {\n          setShowConsentDialog(true);\n        } else if (data.video_enabled) {\n          await requestCameraPermission(data.preferred_resolution);\n        }\n      } else {\n        // If endpoint doesn't exist yet, use defaults\n        setSettings({\n          video_enabled: true,\n          capture_full_interview: false,\n          capture_per_question: true,\n          require_consent: true,\n          consent_captured: false,\n          preferred_resolution: '720p',\n          max_duration_seconds: 300,\n          auto_analyze: true,\n          blur_background: false\n        });\n        setShowConsentDialog(true);\n      }\n      setIsLoading(false);\n    } catch (err) {\n      console.error('Error fetching video settings:', err);\n      // Use defaults on error\n      setSettings({\n        video_enabled: true,\n        capture_full_interview: false,\n        capture_per_question: true,\n        require_consent: true,\n        consent_captured: false,\n        preferred_resolution: '720p',\n        max_duration_seconds: 300,\n        auto_analyze: true,\n        blur_background: false\n      });\n      setIsLoading(false);\n    }\n  };\n  const requestCameraPermission = async (resolution = '720p') => {\n    try {\n      const res = RESOLUTIONS[resolution] || RESOLUTIONS['720p'];\n      const constraints = {\n        video: {\n          width: {\n            ideal: res.width\n          },\n          height: {\n            ideal: res.height\n          },\n          facingMode: 'user'\n        },\n        audio: true\n      };\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      streamRef.current = stream;\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n      }\n      setHasPermission(true);\n    } catch (err) {\n      console.error('Camera permission error:', err);\n      setHasPermission(false);\n      setError('Camera access denied. Please allow camera access to continue.');\n      onError === null || onError === void 0 ? void 0 : onError('Camera access denied');\n    }\n  };\n  const stopStream = () => {\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n    }\n    if (videoRef.current) {\n      videoRef.current.srcObject = null;\n    }\n  };\n  const handleConsentResponse = async consented => {\n    setShowConsentDialog(false);\n    try {\n      const formData = new FormData();\n      formData.append('consent_given', consented.toString());\n\n      // Try to submit consent to backend\n      try {\n        const response = await fetch(`${apiBaseUrl}/api/ai-interviews/public/${accessToken}/video-consent/`, {\n          method: 'POST',\n          body: formData\n        });\n        if (response.ok) {\n          const data = await response.json();\n          setConsentCaptured(consented);\n          onConsentChange === null || onConsentChange === void 0 ? void 0 : onConsentChange(consented);\n        }\n      } catch (e) {\n        // If endpoint doesn't exist, just proceed locally\n        console.warn('Video consent endpoint not available');\n      }\n      setConsentCaptured(consented);\n      onConsentChange === null || onConsentChange === void 0 ? void 0 : onConsentChange(consented);\n      if (consented) {\n        await requestCameraPermission((settings === null || settings === void 0 ? void 0 : settings.preferred_resolution) || '720p');\n      }\n    } catch (err) {\n      console.error('Consent submission error:', err);\n      setError('Failed to submit consent');\n    }\n  };\n  const startRecording = useCallback(() => {\n    if (!streamRef.current) {\n      setError('Camera not available');\n      return;\n    }\n    chunksRef.current = [];\n\n    // Try different codecs\n    let options = {};\n    const codecs = ['video/webm;codecs=vp9,opus', 'video/webm;codecs=vp8,opus', 'video/webm', 'video/mp4'];\n    for (const codec of codecs) {\n      if (MediaRecorder.isTypeSupported(codec)) {\n        options.mimeType = codec;\n        break;\n      }\n    }\n    try {\n      const mediaRecorder = new MediaRecorder(streamRef.current, options);\n      mediaRecorderRef.current = mediaRecorder;\n      mediaRecorder.ondataavailable = event => {\n        if (event.data && event.data.size > 0) {\n          chunksRef.current.push(event.data);\n        }\n      };\n      mediaRecorder.onstop = () => {\n        const blob = new Blob(chunksRef.current, {\n          type: options.mimeType || 'video/webm'\n        });\n        setRecording(prev => ({\n          ...prev,\n          blob,\n          isRecording: false\n        }));\n      };\n      mediaRecorder.start(1000);\n      timerRef.current = setInterval(() => {\n        setRecording(prev => {\n          const newDuration = prev.duration + 1;\n          if (settings !== null && settings !== void 0 && settings.max_duration_seconds && newDuration >= settings.max_duration_seconds) {\n            stopRecording();\n          }\n          return {\n            ...prev,\n            duration: newDuration\n          };\n        });\n      }, 1000);\n      setRecording(prev => ({\n        ...prev,\n        isRecording: true,\n        isPaused: false,\n        duration: 0\n      }));\n    } catch (err) {\n      console.error('Error starting recording:', err);\n      setError('Failed to start recording');\n      onError === null || onError === void 0 ? void 0 : onError('Failed to start recording');\n    }\n  }, [settings]);\n  const stopRecording = useCallback(() => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n      mediaRecorderRef.current.stop();\n    }\n  }, []);\n  const pauseRecording = useCallback(() => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'recording') {\n      mediaRecorderRef.current.pause();\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n      setRecording(prev => ({\n        ...prev,\n        isPaused: true\n      }));\n    }\n  }, []);\n  const resumeRecording = useCallback(() => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'paused') {\n      mediaRecorderRef.current.resume();\n      timerRef.current = setInterval(() => {\n        setRecording(prev => ({\n          ...prev,\n          duration: prev.duration + 1\n        }));\n      }, 1000);\n      setRecording(prev => ({\n        ...prev,\n        isPaused: false\n      }));\n    }\n  }, []);\n  const discardRecording = useCallback(() => {\n    setRecording({\n      isRecording: false,\n      isPaused: false,\n      duration: 0,\n      blob: null\n    });\n    chunksRef.current = [];\n  }, []);\n  const uploadVideo = async () => {\n    if (!recording.blob) {\n      setError('No video to upload');\n      return;\n    }\n    setIsUploading(true);\n    setUploadProgress(0);\n    try {\n      const formData = new FormData();\n      formData.append('video', recording.blob, `recording_${Date.now()}.webm`);\n      formData.append('video_type', videoType);\n      formData.append('duration_seconds', recording.duration.toString());\n      formData.append('recorded_at', new Date().toISOString());\n      if (questionId) {\n        formData.append('question_id', questionId.toString());\n      }\n      const xhr = new XMLHttpRequest();\n      xhr.upload.onprogress = event => {\n        if (event.lengthComputable) {\n          const progress = Math.round(event.loaded / event.total * 100);\n          setUploadProgress(progress);\n        }\n      };\n      const response = await new Promise((resolve, reject) => {\n        xhr.onload = () => {\n          if (xhr.status >= 200 && xhr.status < 300) {\n            try {\n              resolve(JSON.parse(xhr.responseText));\n            } catch {\n              resolve({\n                success: true,\n                video_id: 0\n              });\n            }\n          } else {\n            reject(new Error(xhr.responseText || 'Upload failed'));\n          }\n        };\n        xhr.onerror = () => reject(new Error('Upload failed'));\n        xhr.open('POST', `${apiBaseUrl}/api/ai-interviews/public/${accessToken}/upload-video/`);\n        xhr.send(formData);\n      });\n      setIsUploading(false);\n      setUploadProgress(100);\n      discardRecording();\n      onVideoUploaded === null || onVideoUploaded === void 0 ? void 0 : onVideoUploaded(response.video_id);\n    } catch (err) {\n      console.error('Upload error:', err);\n      setIsUploading(false);\n      setError('Failed to upload video');\n      onError === null || onError === void 0 ? void 0 : onError('Failed to upload video');\n    }\n  };\n  const formatDuration = seconds => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  // Loading state\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center p-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"ml-2 text-gray-600\",\n        children: \"Loading video settings...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Video disabled\n  if (settings && !settings.video_enabled) {\n    return null;\n  }\n\n  // Consent dialog\n  if (showConsentDialog) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg p-6 max-w-md mx-4 shadow-xl\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-gray-900 mb-4\",\n          children: \"\\uD83D\\uDCF9 Video Recording Consent\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-4\",\n          children: \"This interview includes video recording to help verify the authenticity of responses and assess the impact of the grant.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-6\",\n          children: \"Do you consent to video recording during this interview?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleConsentResponse(true),\n            className: \"flex-1 bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition font-medium\",\n            children: \"Yes, I consent\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleConsentResponse(false),\n            className: \"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition font-medium\",\n            children: \"No, skip video\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Permission denied\n  if (hasPermission === false) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-50 border border-red-200 rounded-lg p-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-red-700\",\n        children: \"\\u26A0\\uFE0F Camera access was denied. Please allow camera access in your browser settings to record video.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => requestCameraPermission((settings === null || settings === void 0 ? void 0 : settings.preferred_resolution) || '720p'),\n        className: \"mt-2 text-red-600 underline hover:text-red-800\",\n        children: \"Try again\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Not consented\n  if (!consentCaptured) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600\",\n        children: \"Video recording disabled\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 468,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `video-capture-container ${compact ? 'p-2' : 'p-4'} bg-gray-50 rounded-lg`,\n    children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-50 border border-red-200 rounded-lg p-3 mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-red-700 text-sm\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setError(null),\n        className: \"text-red-500 text-sm underline mt-1\",\n        children: \"Dismiss\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 9\n    }, this), showPreview && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative bg-black rounded-lg overflow-hidden mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        muted: true,\n        playsInline: true,\n        className: `w-full ${compact ? 'h-32' : 'h-48 md:h-64'} object-cover`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 11\n      }, this), recording.isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-3 left-3 flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: `w-3 h-3 rounded-full ${recording.isPaused ? 'bg-yellow-500' : 'bg-red-500 animate-pulse'}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-white text-sm font-medium bg-black bg-opacity-50 px-2 py-1 rounded\",\n          children: [recording.isPaused ? 'PAUSED' : 'REC', \" \", formatDuration(recording.duration)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 13\n      }, this), recording.isRecording && (settings === null || settings === void 0 ? void 0 : settings.max_duration_seconds) && recording.duration >= settings.max_duration_seconds - 30 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute top-3 right-3 bg-yellow-500 text-white text-xs px-2 py-1 rounded\",\n        children: [settings.max_duration_seconds - recording.duration, \"s remaining\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap items-center justify-center gap-2\",\n      children: [!recording.isRecording && !recording.blob && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startRecording,\n        disabled: !hasPermission,\n        className: \"flex items-center space-x-2 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition disabled:opacity-50 disabled:cursor-not-allowed\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"w-3 h-3 bg-white rounded-full\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 528,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: compact ? 'Record' : 'Start Recording'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 523,\n        columnNumber: 11\n      }, this), recording.isRecording && !recording.isPaused && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: pauseRecording,\n          className: \"flex items-center space-x-2 bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u23F8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 539,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Pause\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: stopRecording,\n          className: \"flex items-center space-x-2 bg-gray-700 text-white px-3 py-2 rounded-lg hover:bg-gray-800 transition\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u23F9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 546,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Stop\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), recording.isRecording && recording.isPaused && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: resumeRecording,\n          className: \"flex items-center space-x-2 bg-emerald-500 text-white px-3 py-2 rounded-lg hover:bg-emerald-600 transition\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u25B6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 558,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Resume\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 559,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 554,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: stopRecording,\n          className: \"flex items-center space-x-2 bg-gray-700 text-white px-3 py-2 rounded-lg hover:bg-gray-800 transition\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u23F9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 565,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Stop\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 566,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 561,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), recording.blob && !isUploading && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: uploadVideo,\n          className: \"flex items-center space-x-2 bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u2B06\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 577,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: compact ? 'Upload' : 'Upload Video'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 578,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 573,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: discardRecording,\n          className: \"flex items-center space-x-2 bg-gray-300 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-400 transition\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\uD83D\\uDDD1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 584,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Discard\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 585,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), isUploading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-32 bg-gray-200 rounded-full h-2\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-emerald-600 h-2 rounded-full transition-all duration-300\",\n            style: {\n              width: `${uploadProgress}%`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 592,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-600\",\n          children: [uploadProgress, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 598,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 591,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 7\n    }, this), recording.blob && !isUploading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-3 text-center text-sm text-gray-600\",\n      children: [\"Recording: \", formatDuration(recording.duration), \" | Size: \", (recording.blob.size / 1024 / 1024).toFixed(2), \" MB\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 605,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 475,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoCapture, \"I7bmYh5UcJUSPY41P2CqOcLiAZ8=\");\n_c = VideoCapture;\nexport default VideoCapture;\nvar _c;\n$RefreshReg$(_c, \"VideoCapture\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","jsxDEV","_jsxDEV","Fragment","_Fragment","RESOLUTIONS","width","height","VideoCapture","accessToken","apiBaseUrl","onVideoUploaded","onError","onConsentChange","questionId","videoType","autoStart","showPreview","compact","_s","videoRef","mediaRecorderRef","streamRef","chunksRef","timerRef","settings","setSettings","hasPermission","setHasPermission","isLoading","setIsLoading","error","setError","recording","setRecording","isRecording","isPaused","duration","blob","isUploading","setIsUploading","uploadProgress","setUploadProgress","showConsentDialog","setShowConsentDialog","consentCaptured","setConsentCaptured","fetchVideoSettings","stopStream","current","clearInterval","video_enabled","startRecording","response","fetch","ok","data","json","consent_captured","require_consent","requestCameraPermission","preferred_resolution","capture_full_interview","capture_per_question","max_duration_seconds","auto_analyze","blur_background","err","console","resolution","res","constraints","video","ideal","facingMode","audio","stream","navigator","mediaDevices","getUserMedia","srcObject","getTracks","forEach","track","stop","handleConsentResponse","consented","formData","FormData","append","toString","method","body","e","warn","options","codecs","codec","MediaRecorder","isTypeSupported","mimeType","mediaRecorder","ondataavailable","event","size","push","onstop","Blob","type","prev","start","setInterval","newDuration","stopRecording","state","pauseRecording","pause","resumeRecording","resume","discardRecording","uploadVideo","Date","now","toISOString","xhr","XMLHttpRequest","upload","onprogress","lengthComputable","progress","Math","round","loaded","total","Promise","resolve","reject","onload","status","JSON","parse","responseText","success","video_id","Error","onerror","open","send","formatDuration","seconds","mins","floor","secs","padStart","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","autoPlay","muted","playsInline","disabled","style","toFixed","_c","$RefreshReg$"],"sources":["E:/ANURAG/impact-analysis-frontend/src/components/VideoCapture.tsx"],"sourcesContent":["/**\r\n * VideoCapture.tsx\r\n * React component for capturing video during AI interviews.\r\n * Place this file in: frontend/src/components/VideoCapture.tsx\r\n */\r\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\r\n\r\n// Types\r\ninterface VideoSettings {\r\n  video_enabled: boolean;\r\n  capture_full_interview: boolean;\r\n  capture_per_question: boolean;\r\n  require_consent: boolean;\r\n  consent_captured: boolean;\r\n  preferred_resolution: '480p' | '720p' | '1080p';\r\n  max_duration_seconds: number;\r\n  auto_analyze: boolean;\r\n  blur_background: boolean;\r\n}\r\n\r\ninterface VideoCaptureProps {\r\n  accessToken: string;\r\n  apiBaseUrl: string;\r\n  onVideoUploaded?: (videoId: number) => void;\r\n  onError?: (error: string) => void;\r\n  onConsentChange?: (consented: boolean) => void;\r\n  questionId?: number;\r\n  videoType?: 'question_response' | 'consent_verification' | 'environment_scan';\r\n  autoStart?: boolean;\r\n  showPreview?: boolean;\r\n  compact?: boolean;\r\n}\r\n\r\ninterface RecordingState {\r\n  isRecording: boolean;\r\n  isPaused: boolean;\r\n  duration: number;\r\n  blob: Blob | null;\r\n}\r\n\r\n// Resolution configurations\r\nconst RESOLUTIONS: Record<string, { width: number; height: number }> = {\r\n  '480p': { width: 640, height: 480 },\r\n  '720p': { width: 1280, height: 720 },\r\n  '1080p': { width: 1920, height: 1080 }\r\n};\r\n\r\n// Main Component\r\nconst VideoCapture: React.FC<VideoCaptureProps> = ({\r\n  accessToken,\r\n  apiBaseUrl,\r\n  onVideoUploaded,\r\n  onError,\r\n  onConsentChange,\r\n  questionId,\r\n  videoType = 'question_response',\r\n  autoStart = false,\r\n  showPreview = true,\r\n  compact = false\r\n}) => {\r\n  // Refs\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  const mediaRecorderRef = useRef<MediaRecorder | null>(null);\r\n  const streamRef = useRef<MediaStream | null>(null);\r\n  const chunksRef = useRef<Blob[]>([]);\r\n  const timerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // State\r\n  const [settings, setSettings] = useState<VideoSettings | null>(null);\r\n  const [hasPermission, setHasPermission] = useState<boolean | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [recording, setRecording] = useState<RecordingState>({\r\n    isRecording: false,\r\n    isPaused: false,\r\n    duration: 0,\r\n    blob: null\r\n  });\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState(0);\r\n  const [showConsentDialog, setShowConsentDialog] = useState(false);\r\n  const [consentCaptured, setConsentCaptured] = useState(false);\r\n\r\n  // Fetch video settings on mount\r\n  useEffect(() => {\r\n    fetchVideoSettings();\r\n    return () => {\r\n      stopStream();\r\n      if (timerRef.current) {\r\n        clearInterval(timerRef.current);\r\n      }\r\n    };\r\n  }, [accessToken]);\r\n\r\n  // Auto-start recording if enabled\r\n  useEffect(() => {\r\n    if (autoStart && settings?.video_enabled && consentCaptured && hasPermission) {\r\n      startRecording();\r\n    }\r\n  }, [autoStart, settings, consentCaptured, hasPermission]);\r\n\r\n  const fetchVideoSettings = async () => {\r\n    try {\r\n      const response = await fetch(\r\n        `${apiBaseUrl}/api/ai-interviews/public/${accessToken}/video-settings/`\r\n      );\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setSettings(data);\r\n        setConsentCaptured(data.consent_captured);\r\n        \r\n        if (data.video_enabled && !data.consent_captured && data.require_consent) {\r\n          setShowConsentDialog(true);\r\n        } else if (data.video_enabled) {\r\n          await requestCameraPermission(data.preferred_resolution);\r\n        }\r\n      } else {\r\n        // If endpoint doesn't exist yet, use defaults\r\n        setSettings({\r\n          video_enabled: true,\r\n          capture_full_interview: false,\r\n          capture_per_question: true,\r\n          require_consent: true,\r\n          consent_captured: false,\r\n          preferred_resolution: '720p',\r\n          max_duration_seconds: 300,\r\n          auto_analyze: true,\r\n          blur_background: false\r\n        });\r\n        setShowConsentDialog(true);\r\n      }\r\n      \r\n      setIsLoading(false);\r\n    } catch (err) {\r\n      console.error('Error fetching video settings:', err);\r\n      // Use defaults on error\r\n      setSettings({\r\n        video_enabled: true,\r\n        capture_full_interview: false,\r\n        capture_per_question: true,\r\n        require_consent: true,\r\n        consent_captured: false,\r\n        preferred_resolution: '720p',\r\n        max_duration_seconds: 300,\r\n        auto_analyze: true,\r\n        blur_background: false\r\n      });\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const requestCameraPermission = async (resolution: '480p' | '720p' | '1080p' = '720p') => {\r\n    try {\r\n      const res = RESOLUTIONS[resolution] || RESOLUTIONS['720p'];\r\n      const constraints: MediaStreamConstraints = {\r\n        video: {\r\n          width: { ideal: res.width },\r\n          height: { ideal: res.height },\r\n          facingMode: 'user'\r\n        },\r\n        audio: true\r\n      };\r\n\r\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\r\n      streamRef.current = stream;\r\n      \r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n      }\r\n      \r\n      setHasPermission(true);\r\n    } catch (err) {\r\n      console.error('Camera permission error:', err);\r\n      setHasPermission(false);\r\n      setError('Camera access denied. Please allow camera access to continue.');\r\n      onError?.('Camera access denied');\r\n    }\r\n  };\r\n\r\n  const stopStream = () => {\r\n    if (streamRef.current) {\r\n      streamRef.current.getTracks().forEach(track => track.stop());\r\n      streamRef.current = null;\r\n    }\r\n    if (videoRef.current) {\r\n      videoRef.current.srcObject = null;\r\n    }\r\n  };\r\n\r\n  const handleConsentResponse = async (consented: boolean) => {\r\n    setShowConsentDialog(false);\r\n    \r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('consent_given', consented.toString());\r\n      \r\n      // Try to submit consent to backend\r\n      try {\r\n        const response = await fetch(\r\n          `${apiBaseUrl}/api/ai-interviews/public/${accessToken}/video-consent/`,\r\n          {\r\n            method: 'POST',\r\n            body: formData\r\n          }\r\n        );\r\n        \r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          setConsentCaptured(consented);\r\n          onConsentChange?.(consented);\r\n        }\r\n      } catch (e) {\r\n        // If endpoint doesn't exist, just proceed locally\r\n        console.warn('Video consent endpoint not available');\r\n      }\r\n      \r\n      setConsentCaptured(consented);\r\n      onConsentChange?.(consented);\r\n      \r\n      if (consented) {\r\n        await requestCameraPermission(settings?.preferred_resolution || '720p');\r\n      }\r\n    } catch (err) {\r\n      console.error('Consent submission error:', err);\r\n      setError('Failed to submit consent');\r\n    }\r\n  };\r\n\r\n  const startRecording = useCallback(() => {\r\n    if (!streamRef.current) {\r\n      setError('Camera not available');\r\n      return;\r\n    }\r\n\r\n    chunksRef.current = [];\r\n    \r\n    // Try different codecs\r\n    let options: MediaRecorderOptions = {};\r\n    const codecs = [\r\n      'video/webm;codecs=vp9,opus',\r\n      'video/webm;codecs=vp8,opus',\r\n      'video/webm',\r\n      'video/mp4'\r\n    ];\r\n    \r\n    for (const codec of codecs) {\r\n      if (MediaRecorder.isTypeSupported(codec)) {\r\n        options.mimeType = codec;\r\n        break;\r\n      }\r\n    }\r\n\r\n    try {\r\n      const mediaRecorder = new MediaRecorder(streamRef.current, options);\r\n      mediaRecorderRef.current = mediaRecorder;\r\n      \r\n      mediaRecorder.ondataavailable = (event) => {\r\n        if (event.data && event.data.size > 0) {\r\n          chunksRef.current.push(event.data);\r\n        }\r\n      };\r\n      \r\n      mediaRecorder.onstop = () => {\r\n        const blob = new Blob(chunksRef.current, { type: options.mimeType || 'video/webm' });\r\n        setRecording(prev => ({ ...prev, blob, isRecording: false }));\r\n      };\r\n      \r\n      mediaRecorder.start(1000);\r\n      \r\n      timerRef.current = setInterval(() => {\r\n        setRecording(prev => {\r\n          const newDuration = prev.duration + 1;\r\n          \r\n          if (settings?.max_duration_seconds && newDuration >= settings.max_duration_seconds) {\r\n            stopRecording();\r\n          }\r\n          \r\n          return { ...prev, duration: newDuration };\r\n        });\r\n      }, 1000);\r\n      \r\n      setRecording(prev => ({ ...prev, isRecording: true, isPaused: false, duration: 0 }));\r\n    } catch (err) {\r\n      console.error('Error starting recording:', err);\r\n      setError('Failed to start recording');\r\n      onError?.('Failed to start recording');\r\n    }\r\n  }, [settings]);\r\n\r\n  const stopRecording = useCallback(() => {\r\n    if (timerRef.current) {\r\n      clearInterval(timerRef.current);\r\n      timerRef.current = null;\r\n    }\r\n    \r\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\r\n      mediaRecorderRef.current.stop();\r\n    }\r\n  }, []);\r\n\r\n  const pauseRecording = useCallback(() => {\r\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'recording') {\r\n      mediaRecorderRef.current.pause();\r\n      if (timerRef.current) {\r\n        clearInterval(timerRef.current);\r\n      }\r\n      setRecording(prev => ({ ...prev, isPaused: true }));\r\n    }\r\n  }, []);\r\n\r\n  const resumeRecording = useCallback(() => {\r\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'paused') {\r\n      mediaRecorderRef.current.resume();\r\n      timerRef.current = setInterval(() => {\r\n        setRecording(prev => ({ ...prev, duration: prev.duration + 1 }));\r\n      }, 1000);\r\n      setRecording(prev => ({ ...prev, isPaused: false }));\r\n    }\r\n  }, []);\r\n\r\n  const discardRecording = useCallback(() => {\r\n    setRecording({\r\n      isRecording: false,\r\n      isPaused: false,\r\n      duration: 0,\r\n      blob: null\r\n    });\r\n    chunksRef.current = [];\r\n  }, []);\r\n\r\n  const uploadVideo = async () => {\r\n    if (!recording.blob) {\r\n      setError('No video to upload');\r\n      return;\r\n    }\r\n\r\n    setIsUploading(true);\r\n    setUploadProgress(0);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('video', recording.blob, `recording_${Date.now()}.webm`);\r\n      formData.append('video_type', videoType);\r\n      formData.append('duration_seconds', recording.duration.toString());\r\n      formData.append('recorded_at', new Date().toISOString());\r\n      \r\n      if (questionId) {\r\n        formData.append('question_id', questionId.toString());\r\n      }\r\n\r\n      const xhr = new XMLHttpRequest();\r\n      \r\n      xhr.upload.onprogress = (event) => {\r\n        if (event.lengthComputable) {\r\n          const progress = Math.round((event.loaded / event.total) * 100);\r\n          setUploadProgress(progress);\r\n        }\r\n      };\r\n\r\n      const response = await new Promise<any>((resolve, reject) => {\r\n        xhr.onload = () => {\r\n          if (xhr.status >= 200 && xhr.status < 300) {\r\n            try {\r\n              resolve(JSON.parse(xhr.responseText));\r\n            } catch {\r\n              resolve({ success: true, video_id: 0 });\r\n            }\r\n          } else {\r\n            reject(new Error(xhr.responseText || 'Upload failed'));\r\n          }\r\n        };\r\n        xhr.onerror = () => reject(new Error('Upload failed'));\r\n        \r\n        xhr.open('POST', `${apiBaseUrl}/api/ai-interviews/public/${accessToken}/upload-video/`);\r\n        xhr.send(formData);\r\n      });\r\n\r\n      setIsUploading(false);\r\n      setUploadProgress(100);\r\n      \r\n      discardRecording();\r\n      onVideoUploaded?.(response.video_id);\r\n      \r\n    } catch (err: any) {\r\n      console.error('Upload error:', err);\r\n      setIsUploading(false);\r\n      setError('Failed to upload video');\r\n      onError?.('Failed to upload video');\r\n    }\r\n  };\r\n\r\n  const formatDuration = (seconds: number): string => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  // Loading state\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-4\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600\"></div>\r\n        <span className=\"ml-2 text-gray-600\">Loading video settings...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Video disabled\r\n  if (settings && !settings.video_enabled) {\r\n    return null;\r\n  }\r\n\r\n  // Consent dialog\r\n  if (showConsentDialog) {\r\n    return (\r\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n        <div className=\"bg-white rounded-lg p-6 max-w-md mx-4 shadow-xl\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n            üìπ Video Recording Consent\r\n          </h3>\r\n          <p className=\"text-gray-600 mb-4\">\r\n            This interview includes video recording to help verify the authenticity of responses \r\n            and assess the impact of the grant.\r\n          </p>\r\n          <p className=\"text-gray-600 mb-6\">\r\n            Do you consent to video recording during this interview?\r\n          </p>\r\n          <div className=\"flex space-x-4\">\r\n            <button\r\n              onClick={() => handleConsentResponse(true)}\r\n              className=\"flex-1 bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition font-medium\"\r\n            >\r\n              Yes, I consent\r\n            </button>\r\n            <button\r\n              onClick={() => handleConsentResponse(false)}\r\n              className=\"flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition font-medium\"\r\n            >\r\n              No, skip video\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Permission denied\r\n  if (hasPermission === false) {\r\n    return (\r\n      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n        <p className=\"text-red-700\">\r\n          ‚ö†Ô∏è Camera access was denied. Please allow camera access in your browser settings to record video.\r\n        </p>\r\n        <button\r\n          onClick={() => requestCameraPermission(settings?.preferred_resolution || '720p')}\r\n          className=\"mt-2 text-red-600 underline hover:text-red-800\"\r\n        >\r\n          Try again\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Not consented\r\n  if (!consentCaptured) {\r\n    return (\r\n      <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center\">\r\n        <p className=\"text-gray-600\">Video recording disabled</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`video-capture-container ${compact ? 'p-2' : 'p-4'} bg-gray-50 rounded-lg`}>\r\n      {/* Error display */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 mb-4\">\r\n          <p className=\"text-red-700 text-sm\">{error}</p>\r\n          <button\r\n            onClick={() => setError(null)}\r\n            className=\"text-red-500 text-sm underline mt-1\"\r\n          >\r\n            Dismiss\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Video preview */}\r\n      {showPreview && (\r\n        <div className=\"relative bg-black rounded-lg overflow-hidden mb-4\">\r\n          <video\r\n            ref={videoRef}\r\n            autoPlay\r\n            muted\r\n            playsInline\r\n            className={`w-full ${compact ? 'h-32' : 'h-48 md:h-64'} object-cover`}\r\n          />\r\n          \r\n          {/* Recording indicator */}\r\n          {recording.isRecording && (\r\n            <div className=\"absolute top-3 left-3 flex items-center space-x-2\">\r\n              <span className={`w-3 h-3 rounded-full ${recording.isPaused ? 'bg-yellow-500' : 'bg-red-500 animate-pulse'}`}></span>\r\n              <span className=\"text-white text-sm font-medium bg-black bg-opacity-50 px-2 py-1 rounded\">\r\n                {recording.isPaused ? 'PAUSED' : 'REC'} {formatDuration(recording.duration)}\r\n              </span>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Max duration warning */}\r\n          {recording.isRecording && settings?.max_duration_seconds && \r\n           recording.duration >= settings.max_duration_seconds - 30 && (\r\n            <div className=\"absolute top-3 right-3 bg-yellow-500 text-white text-xs px-2 py-1 rounded\">\r\n              {settings.max_duration_seconds - recording.duration}s remaining\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Controls */}\r\n      <div className=\"flex flex-wrap items-center justify-center gap-2\">\r\n        {!recording.isRecording && !recording.blob && (\r\n          <button\r\n            onClick={startRecording}\r\n            disabled={!hasPermission}\r\n            className=\"flex items-center space-x-2 bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            <span className=\"w-3 h-3 bg-white rounded-full\"></span>\r\n            <span>{compact ? 'Record' : 'Start Recording'}</span>\r\n          </button>\r\n        )}\r\n\r\n        {recording.isRecording && !recording.isPaused && (\r\n          <>\r\n            <button\r\n              onClick={pauseRecording}\r\n              className=\"flex items-center space-x-2 bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 transition\"\r\n            >\r\n              <span>‚è∏</span>\r\n              <span>Pause</span>\r\n            </button>\r\n            <button\r\n              onClick={stopRecording}\r\n              className=\"flex items-center space-x-2 bg-gray-700 text-white px-3 py-2 rounded-lg hover:bg-gray-800 transition\"\r\n            >\r\n              <span>‚èπ</span>\r\n              <span>Stop</span>\r\n            </button>\r\n          </>\r\n        )}\r\n\r\n        {recording.isRecording && recording.isPaused && (\r\n          <>\r\n            <button\r\n              onClick={resumeRecording}\r\n              className=\"flex items-center space-x-2 bg-emerald-500 text-white px-3 py-2 rounded-lg hover:bg-emerald-600 transition\"\r\n            >\r\n              <span>‚ñ∂</span>\r\n              <span>Resume</span>\r\n            </button>\r\n            <button\r\n              onClick={stopRecording}\r\n              className=\"flex items-center space-x-2 bg-gray-700 text-white px-3 py-2 rounded-lg hover:bg-gray-800 transition\"\r\n            >\r\n              <span>‚èπ</span>\r\n              <span>Stop</span>\r\n            </button>\r\n          </>\r\n        )}\r\n\r\n        {recording.blob && !isUploading && (\r\n          <>\r\n            <button\r\n              onClick={uploadVideo}\r\n              className=\"flex items-center space-x-2 bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition\"\r\n            >\r\n              <span>‚¨Ü</span>\r\n              <span>{compact ? 'Upload' : 'Upload Video'}</span>\r\n            </button>\r\n            <button\r\n              onClick={discardRecording}\r\n              className=\"flex items-center space-x-2 bg-gray-300 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-400 transition\"\r\n            >\r\n              <span>üóë</span>\r\n              <span>Discard</span>\r\n            </button>\r\n          </>\r\n        )}\r\n\r\n        {isUploading && (\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"w-32 bg-gray-200 rounded-full h-2\">\r\n              <div \r\n                className=\"bg-emerald-600 h-2 rounded-full transition-all duration-300\"\r\n                style={{ width: `${uploadProgress}%` }}\r\n              ></div>\r\n            </div>\r\n            <span className=\"text-sm text-gray-600\">{uploadProgress}%</span>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Recording info */}\r\n      {recording.blob && !isUploading && (\r\n        <div className=\"mt-3 text-center text-sm text-gray-600\">\r\n          Recording: {formatDuration(recording.duration)} | \r\n          Size: {(recording.blob.size / 1024 / 1024).toFixed(2)} MB\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoCapture;"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;;AAEvE;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAiCA;AACA,MAAMC,WAA8D,GAAG;EACrE,MAAM,EAAE;IAAEC,KAAK,EAAE,GAAG;IAAEC,MAAM,EAAE;EAAI,CAAC;EACnC,MAAM,EAAE;IAAED,KAAK,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAI,CAAC;EACpC,OAAO,EAAE;IAAED,KAAK,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAK;AACvC,CAAC;;AAED;AACA,MAAMC,YAAyC,GAAGA,CAAC;EACjDC,WAAW;EACXC,UAAU;EACVC,eAAe;EACfC,OAAO;EACPC,eAAe;EACfC,UAAU;EACVC,SAAS,GAAG,mBAAmB;EAC/BC,SAAS,GAAG,KAAK;EACjBC,WAAW,GAAG,IAAI;EAClBC,OAAO,GAAG;AACZ,CAAC,KAAK;EAAAC,EAAA;EACJ;EACA,MAAMC,QAAQ,GAAGtB,MAAM,CAAmB,IAAI,CAAC;EAC/C,MAAMuB,gBAAgB,GAAGvB,MAAM,CAAuB,IAAI,CAAC;EAC3D,MAAMwB,SAAS,GAAGxB,MAAM,CAAqB,IAAI,CAAC;EAClD,MAAMyB,SAAS,GAAGzB,MAAM,CAAS,EAAE,CAAC;EACpC,MAAM0B,QAAQ,GAAG1B,MAAM,CAAwB,IAAI,CAAC;;EAEpD;EACA,MAAM,CAAC2B,QAAQ,EAAEC,WAAW,CAAC,GAAG7B,QAAQ,CAAuB,IAAI,CAAC;EACpE,MAAM,CAAC8B,aAAa,EAAEC,gBAAgB,CAAC,GAAG/B,QAAQ,CAAiB,IAAI,CAAC;EACxE,MAAM,CAACgC,SAAS,EAAEC,YAAY,CAAC,GAAGjC,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACkC,KAAK,EAAEC,QAAQ,CAAC,GAAGnC,QAAQ,CAAgB,IAAI,CAAC;EACvD,MAAM,CAACoC,SAAS,EAAEC,YAAY,CAAC,GAAGrC,QAAQ,CAAiB;IACzDsC,WAAW,EAAE,KAAK;IAClBC,QAAQ,EAAE,KAAK;IACfC,QAAQ,EAAE,CAAC;IACXC,IAAI,EAAE;EACR,CAAC,CAAC;EACF,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAG3C,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAAC4C,cAAc,EAAEC,iBAAiB,CAAC,GAAG7C,QAAQ,CAAC,CAAC,CAAC;EACvD,MAAM,CAAC8C,iBAAiB,EAAEC,oBAAoB,CAAC,GAAG/C,QAAQ,CAAC,KAAK,CAAC;EACjE,MAAM,CAACgD,eAAe,EAAEC,kBAAkB,CAAC,GAAGjD,QAAQ,CAAC,KAAK,CAAC;;EAE7D;EACAE,SAAS,CAAC,MAAM;IACdgD,kBAAkB,CAAC,CAAC;IACpB,OAAO,MAAM;MACXC,UAAU,CAAC,CAAC;MACZ,IAAIxB,QAAQ,CAACyB,OAAO,EAAE;QACpBC,aAAa,CAAC1B,QAAQ,CAACyB,OAAO,CAAC;MACjC;IACF,CAAC;EACH,CAAC,EAAE,CAACxC,WAAW,CAAC,CAAC;;EAEjB;EACAV,SAAS,CAAC,MAAM;IACd,IAAIiB,SAAS,IAAIS,QAAQ,aAARA,QAAQ,eAARA,QAAQ,CAAE0B,aAAa,IAAIN,eAAe,IAAIlB,aAAa,EAAE;MAC5EyB,cAAc,CAAC,CAAC;IAClB;EACF,CAAC,EAAE,CAACpC,SAAS,EAAES,QAAQ,EAAEoB,eAAe,EAAElB,aAAa,CAAC,CAAC;EAEzD,MAAMoB,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACrC,IAAI;MACF,MAAMM,QAAQ,GAAG,MAAMC,KAAK,CAC1B,GAAG5C,UAAU,6BAA6BD,WAAW,kBACvD,CAAC;MAED,IAAI4C,QAAQ,CAACE,EAAE,EAAE;QACf,MAAMC,IAAI,GAAG,MAAMH,QAAQ,CAACI,IAAI,CAAC,CAAC;QAClC/B,WAAW,CAAC8B,IAAI,CAAC;QACjBV,kBAAkB,CAACU,IAAI,CAACE,gBAAgB,CAAC;QAEzC,IAAIF,IAAI,CAACL,aAAa,IAAI,CAACK,IAAI,CAACE,gBAAgB,IAAIF,IAAI,CAACG,eAAe,EAAE;UACxEf,oBAAoB,CAAC,IAAI,CAAC;QAC5B,CAAC,MAAM,IAAIY,IAAI,CAACL,aAAa,EAAE;UAC7B,MAAMS,uBAAuB,CAACJ,IAAI,CAACK,oBAAoB,CAAC;QAC1D;MACF,CAAC,MAAM;QACL;QACAnC,WAAW,CAAC;UACVyB,aAAa,EAAE,IAAI;UACnBW,sBAAsB,EAAE,KAAK;UAC7BC,oBAAoB,EAAE,IAAI;UAC1BJ,eAAe,EAAE,IAAI;UACrBD,gBAAgB,EAAE,KAAK;UACvBG,oBAAoB,EAAE,MAAM;UAC5BG,oBAAoB,EAAE,GAAG;UACzBC,YAAY,EAAE,IAAI;UAClBC,eAAe,EAAE;QACnB,CAAC,CAAC;QACFtB,oBAAoB,CAAC,IAAI,CAAC;MAC5B;MAEAd,YAAY,CAAC,KAAK,CAAC;IACrB,CAAC,CAAC,OAAOqC,GAAG,EAAE;MACZC,OAAO,CAACrC,KAAK,CAAC,gCAAgC,EAAEoC,GAAG,CAAC;MACpD;MACAzC,WAAW,CAAC;QACVyB,aAAa,EAAE,IAAI;QACnBW,sBAAsB,EAAE,KAAK;QAC7BC,oBAAoB,EAAE,IAAI;QAC1BJ,eAAe,EAAE,IAAI;QACrBD,gBAAgB,EAAE,KAAK;QACvBG,oBAAoB,EAAE,MAAM;QAC5BG,oBAAoB,EAAE,GAAG;QACzBC,YAAY,EAAE,IAAI;QAClBC,eAAe,EAAE;MACnB,CAAC,CAAC;MACFpC,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAED,MAAM8B,uBAAuB,GAAG,MAAAA,CAAOS,UAAqC,GAAG,MAAM,KAAK;IACxF,IAAI;MACF,MAAMC,GAAG,GAAGjE,WAAW,CAACgE,UAAU,CAAC,IAAIhE,WAAW,CAAC,MAAM,CAAC;MAC1D,MAAMkE,WAAmC,GAAG;QAC1CC,KAAK,EAAE;UACLlE,KAAK,EAAE;YAAEmE,KAAK,EAAEH,GAAG,CAAChE;UAAM,CAAC;UAC3BC,MAAM,EAAE;YAAEkE,KAAK,EAAEH,GAAG,CAAC/D;UAAO,CAAC;UAC7BmE,UAAU,EAAE;QACd,CAAC;QACDC,KAAK,EAAE;MACT,CAAC;MAED,MAAMC,MAAM,GAAG,MAAMC,SAAS,CAACC,YAAY,CAACC,YAAY,CAACR,WAAW,CAAC;MACrEjD,SAAS,CAAC2B,OAAO,GAAG2B,MAAM;MAE1B,IAAIxD,QAAQ,CAAC6B,OAAO,EAAE;QACpB7B,QAAQ,CAAC6B,OAAO,CAAC+B,SAAS,GAAGJ,MAAM;MACrC;MAEAhD,gBAAgB,CAAC,IAAI,CAAC;IACxB,CAAC,CAAC,OAAOuC,GAAG,EAAE;MACZC,OAAO,CAACrC,KAAK,CAAC,0BAA0B,EAAEoC,GAAG,CAAC;MAC9CvC,gBAAgB,CAAC,KAAK,CAAC;MACvBI,QAAQ,CAAC,+DAA+D,CAAC;MACzEpB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAG,sBAAsB,CAAC;IACnC;EACF,CAAC;EAED,MAAMoC,UAAU,GAAGA,CAAA,KAAM;IACvB,IAAI1B,SAAS,CAAC2B,OAAO,EAAE;MACrB3B,SAAS,CAAC2B,OAAO,CAACgC,SAAS,CAAC,CAAC,CAACC,OAAO,CAACC,KAAK,IAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC;MAC5D9D,SAAS,CAAC2B,OAAO,GAAG,IAAI;IAC1B;IACA,IAAI7B,QAAQ,CAAC6B,OAAO,EAAE;MACpB7B,QAAQ,CAAC6B,OAAO,CAAC+B,SAAS,GAAG,IAAI;IACnC;EACF,CAAC;EAED,MAAMK,qBAAqB,GAAG,MAAOC,SAAkB,IAAK;IAC1D1C,oBAAoB,CAAC,KAAK,CAAC;IAE3B,IAAI;MACF,MAAM2C,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAC/BD,QAAQ,CAACE,MAAM,CAAC,eAAe,EAAEH,SAAS,CAACI,QAAQ,CAAC,CAAC,CAAC;;MAEtD;MACA,IAAI;QACF,MAAMrC,QAAQ,GAAG,MAAMC,KAAK,CAC1B,GAAG5C,UAAU,6BAA6BD,WAAW,iBAAiB,EACtE;UACEkF,MAAM,EAAE,MAAM;UACdC,IAAI,EAAEL;QACR,CACF,CAAC;QAED,IAAIlC,QAAQ,CAACE,EAAE,EAAE;UACf,MAAMC,IAAI,GAAG,MAAMH,QAAQ,CAACI,IAAI,CAAC,CAAC;UAClCX,kBAAkB,CAACwC,SAAS,CAAC;UAC7BzE,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAGyE,SAAS,CAAC;QAC9B;MACF,CAAC,CAAC,OAAOO,CAAC,EAAE;QACV;QACAzB,OAAO,CAAC0B,IAAI,CAAC,sCAAsC,CAAC;MACtD;MAEAhD,kBAAkB,CAACwC,SAAS,CAAC;MAC7BzE,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAGyE,SAAS,CAAC;MAE5B,IAAIA,SAAS,EAAE;QACb,MAAM1B,uBAAuB,CAAC,CAAAnC,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEoC,oBAAoB,KAAI,MAAM,CAAC;MACzE;IACF,CAAC,CAAC,OAAOM,GAAG,EAAE;MACZC,OAAO,CAACrC,KAAK,CAAC,2BAA2B,EAAEoC,GAAG,CAAC;MAC/CnC,QAAQ,CAAC,0BAA0B,CAAC;IACtC;EACF,CAAC;EAED,MAAMoB,cAAc,GAAGpD,WAAW,CAAC,MAAM;IACvC,IAAI,CAACsB,SAAS,CAAC2B,OAAO,EAAE;MACtBjB,QAAQ,CAAC,sBAAsB,CAAC;MAChC;IACF;IAEAT,SAAS,CAAC0B,OAAO,GAAG,EAAE;;IAEtB;IACA,IAAI8C,OAA6B,GAAG,CAAC,CAAC;IACtC,MAAMC,MAAM,GAAG,CACb,4BAA4B,EAC5B,4BAA4B,EAC5B,YAAY,EACZ,WAAW,CACZ;IAED,KAAK,MAAMC,KAAK,IAAID,MAAM,EAAE;MAC1B,IAAIE,aAAa,CAACC,eAAe,CAACF,KAAK,CAAC,EAAE;QACxCF,OAAO,CAACK,QAAQ,GAAGH,KAAK;QACxB;MACF;IACF;IAEA,IAAI;MACF,MAAMI,aAAa,GAAG,IAAIH,aAAa,CAAC5E,SAAS,CAAC2B,OAAO,EAAE8C,OAAO,CAAC;MACnE1E,gBAAgB,CAAC4B,OAAO,GAAGoD,aAAa;MAExCA,aAAa,CAACC,eAAe,GAAIC,KAAK,IAAK;QACzC,IAAIA,KAAK,CAAC/C,IAAI,IAAI+C,KAAK,CAAC/C,IAAI,CAACgD,IAAI,GAAG,CAAC,EAAE;UACrCjF,SAAS,CAAC0B,OAAO,CAACwD,IAAI,CAACF,KAAK,CAAC/C,IAAI,CAAC;QACpC;MACF,CAAC;MAED6C,aAAa,CAACK,MAAM,GAAG,MAAM;QAC3B,MAAMpE,IAAI,GAAG,IAAIqE,IAAI,CAACpF,SAAS,CAAC0B,OAAO,EAAE;UAAE2D,IAAI,EAAEb,OAAO,CAACK,QAAQ,IAAI;QAAa,CAAC,CAAC;QACpFlE,YAAY,CAAC2E,IAAI,KAAK;UAAE,GAAGA,IAAI;UAAEvE,IAAI;UAAEH,WAAW,EAAE;QAAM,CAAC,CAAC,CAAC;MAC/D,CAAC;MAEDkE,aAAa,CAACS,KAAK,CAAC,IAAI,CAAC;MAEzBtF,QAAQ,CAACyB,OAAO,GAAG8D,WAAW,CAAC,MAAM;QACnC7E,YAAY,CAAC2E,IAAI,IAAI;UACnB,MAAMG,WAAW,GAAGH,IAAI,CAACxE,QAAQ,GAAG,CAAC;UAErC,IAAIZ,QAAQ,aAARA,QAAQ,eAARA,QAAQ,CAAEuC,oBAAoB,IAAIgD,WAAW,IAAIvF,QAAQ,CAACuC,oBAAoB,EAAE;YAClFiD,aAAa,CAAC,CAAC;UACjB;UAEA,OAAO;YAAE,GAAGJ,IAAI;YAAExE,QAAQ,EAAE2E;UAAY,CAAC;QAC3C,CAAC,CAAC;MACJ,CAAC,EAAE,IAAI,CAAC;MAER9E,YAAY,CAAC2E,IAAI,KAAK;QAAE,GAAGA,IAAI;QAAE1E,WAAW,EAAE,IAAI;QAAEC,QAAQ,EAAE,KAAK;QAAEC,QAAQ,EAAE;MAAE,CAAC,CAAC,CAAC;IACtF,CAAC,CAAC,OAAO8B,GAAG,EAAE;MACZC,OAAO,CAACrC,KAAK,CAAC,2BAA2B,EAAEoC,GAAG,CAAC;MAC/CnC,QAAQ,CAAC,2BAA2B,CAAC;MACrCpB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAG,2BAA2B,CAAC;IACxC;EACF,CAAC,EAAE,CAACa,QAAQ,CAAC,CAAC;EAEd,MAAMwF,aAAa,GAAGjH,WAAW,CAAC,MAAM;IACtC,IAAIwB,QAAQ,CAACyB,OAAO,EAAE;MACpBC,aAAa,CAAC1B,QAAQ,CAACyB,OAAO,CAAC;MAC/BzB,QAAQ,CAACyB,OAAO,GAAG,IAAI;IACzB;IAEA,IAAI5B,gBAAgB,CAAC4B,OAAO,IAAI5B,gBAAgB,CAAC4B,OAAO,CAACiE,KAAK,KAAK,UAAU,EAAE;MAC7E7F,gBAAgB,CAAC4B,OAAO,CAACmC,IAAI,CAAC,CAAC;IACjC;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAM+B,cAAc,GAAGnH,WAAW,CAAC,MAAM;IACvC,IAAIqB,gBAAgB,CAAC4B,OAAO,IAAI5B,gBAAgB,CAAC4B,OAAO,CAACiE,KAAK,KAAK,WAAW,EAAE;MAC9E7F,gBAAgB,CAAC4B,OAAO,CAACmE,KAAK,CAAC,CAAC;MAChC,IAAI5F,QAAQ,CAACyB,OAAO,EAAE;QACpBC,aAAa,CAAC1B,QAAQ,CAACyB,OAAO,CAAC;MACjC;MACAf,YAAY,CAAC2E,IAAI,KAAK;QAAE,GAAGA,IAAI;QAAEzE,QAAQ,EAAE;MAAK,CAAC,CAAC,CAAC;IACrD;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMiF,eAAe,GAAGrH,WAAW,CAAC,MAAM;IACxC,IAAIqB,gBAAgB,CAAC4B,OAAO,IAAI5B,gBAAgB,CAAC4B,OAAO,CAACiE,KAAK,KAAK,QAAQ,EAAE;MAC3E7F,gBAAgB,CAAC4B,OAAO,CAACqE,MAAM,CAAC,CAAC;MACjC9F,QAAQ,CAACyB,OAAO,GAAG8D,WAAW,CAAC,MAAM;QACnC7E,YAAY,CAAC2E,IAAI,KAAK;UAAE,GAAGA,IAAI;UAAExE,QAAQ,EAAEwE,IAAI,CAACxE,QAAQ,GAAG;QAAE,CAAC,CAAC,CAAC;MAClE,CAAC,EAAE,IAAI,CAAC;MACRH,YAAY,CAAC2E,IAAI,KAAK;QAAE,GAAGA,IAAI;QAAEzE,QAAQ,EAAE;MAAM,CAAC,CAAC,CAAC;IACtD;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMmF,gBAAgB,GAAGvH,WAAW,CAAC,MAAM;IACzCkC,YAAY,CAAC;MACXC,WAAW,EAAE,KAAK;MAClBC,QAAQ,EAAE,KAAK;MACfC,QAAQ,EAAE,CAAC;MACXC,IAAI,EAAE;IACR,CAAC,CAAC;IACFf,SAAS,CAAC0B,OAAO,GAAG,EAAE;EACxB,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMuE,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI,CAACvF,SAAS,CAACK,IAAI,EAAE;MACnBN,QAAQ,CAAC,oBAAoB,CAAC;MAC9B;IACF;IAEAQ,cAAc,CAAC,IAAI,CAAC;IACpBE,iBAAiB,CAAC,CAAC,CAAC;IAEpB,IAAI;MACF,MAAM6C,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;MAC/BD,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAExD,SAAS,CAACK,IAAI,EAAE,aAAamF,IAAI,CAACC,GAAG,CAAC,CAAC,OAAO,CAAC;MACxEnC,QAAQ,CAACE,MAAM,CAAC,YAAY,EAAE1E,SAAS,CAAC;MACxCwE,QAAQ,CAACE,MAAM,CAAC,kBAAkB,EAAExD,SAAS,CAACI,QAAQ,CAACqD,QAAQ,CAAC,CAAC,CAAC;MAClEH,QAAQ,CAACE,MAAM,CAAC,aAAa,EAAE,IAAIgC,IAAI,CAAC,CAAC,CAACE,WAAW,CAAC,CAAC,CAAC;MAExD,IAAI7G,UAAU,EAAE;QACdyE,QAAQ,CAACE,MAAM,CAAC,aAAa,EAAE3E,UAAU,CAAC4E,QAAQ,CAAC,CAAC,CAAC;MACvD;MAEA,MAAMkC,GAAG,GAAG,IAAIC,cAAc,CAAC,CAAC;MAEhCD,GAAG,CAACE,MAAM,CAACC,UAAU,GAAIxB,KAAK,IAAK;QACjC,IAAIA,KAAK,CAACyB,gBAAgB,EAAE;UAC1B,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAAE5B,KAAK,CAAC6B,MAAM,GAAG7B,KAAK,CAAC8B,KAAK,GAAI,GAAG,CAAC;UAC/D3F,iBAAiB,CAACuF,QAAQ,CAAC;QAC7B;MACF,CAAC;MAED,MAAM5E,QAAQ,GAAG,MAAM,IAAIiF,OAAO,CAAM,CAACC,OAAO,EAAEC,MAAM,KAAK;QAC3DZ,GAAG,CAACa,MAAM,GAAG,MAAM;UACjB,IAAIb,GAAG,CAACc,MAAM,IAAI,GAAG,IAAId,GAAG,CAACc,MAAM,GAAG,GAAG,EAAE;YACzC,IAAI;cACFH,OAAO,CAACI,IAAI,CAACC,KAAK,CAAChB,GAAG,CAACiB,YAAY,CAAC,CAAC;YACvC,CAAC,CAAC,MAAM;cACNN,OAAO,CAAC;gBAAEO,OAAO,EAAE,IAAI;gBAAEC,QAAQ,EAAE;cAAE,CAAC,CAAC;YACzC;UACF,CAAC,MAAM;YACLP,MAAM,CAAC,IAAIQ,KAAK,CAACpB,GAAG,CAACiB,YAAY,IAAI,eAAe,CAAC,CAAC;UACxD;QACF,CAAC;QACDjB,GAAG,CAACqB,OAAO,GAAG,MAAMT,MAAM,CAAC,IAAIQ,KAAK,CAAC,eAAe,CAAC,CAAC;QAEtDpB,GAAG,CAACsB,IAAI,CAAC,MAAM,EAAE,GAAGxI,UAAU,6BAA6BD,WAAW,gBAAgB,CAAC;QACvFmH,GAAG,CAACuB,IAAI,CAAC5D,QAAQ,CAAC;MACpB,CAAC,CAAC;MAEF/C,cAAc,CAAC,KAAK,CAAC;MACrBE,iBAAiB,CAAC,GAAG,CAAC;MAEtB6E,gBAAgB,CAAC,CAAC;MAClB5G,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAG0C,QAAQ,CAAC0F,QAAQ,CAAC;IAEtC,CAAC,CAAC,OAAO5E,GAAQ,EAAE;MACjBC,OAAO,CAACrC,KAAK,CAAC,eAAe,EAAEoC,GAAG,CAAC;MACnC3B,cAAc,CAAC,KAAK,CAAC;MACrBR,QAAQ,CAAC,wBAAwB,CAAC;MAClCpB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAG,wBAAwB,CAAC;IACrC;EACF,CAAC;EAED,MAAMwI,cAAc,GAAIC,OAAe,IAAa;IAClD,MAAMC,IAAI,GAAGpB,IAAI,CAACqB,KAAK,CAACF,OAAO,GAAG,EAAE,CAAC;IACrC,MAAMG,IAAI,GAAGH,OAAO,GAAG,EAAE;IACzB,OAAO,GAAGC,IAAI,CAAC5D,QAAQ,CAAC,CAAC,CAAC+D,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,IAAID,IAAI,CAAC9D,QAAQ,CAAC,CAAC,CAAC+D,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;EAClF,CAAC;;EAED;EACA,IAAI5H,SAAS,EAAE;IACb,oBACE3B,OAAA;MAAKwJ,SAAS,EAAC,sCAAsC;MAAAC,QAAA,gBACnDzJ,OAAA;QAAKwJ,SAAS,EAAC;MAAiE;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eACvF7J,OAAA;QAAMwJ,SAAS,EAAC,oBAAoB;QAAAC,QAAA,EAAC;MAAyB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAClE,CAAC;EAEV;;EAEA;EACA,IAAItI,QAAQ,IAAI,CAACA,QAAQ,CAAC0B,aAAa,EAAE;IACvC,OAAO,IAAI;EACb;;EAEA;EACA,IAAIR,iBAAiB,EAAE;IACrB,oBACEzC,OAAA;MAAKwJ,SAAS,EAAC,4EAA4E;MAAAC,QAAA,eACzFzJ,OAAA;QAAKwJ,SAAS,EAAC,iDAAiD;QAAAC,QAAA,gBAC9DzJ,OAAA;UAAIwJ,SAAS,EAAC,0CAA0C;UAAAC,QAAA,EAAC;QAEzD;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACL7J,OAAA;UAAGwJ,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAGlC;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACJ7J,OAAA;UAAGwJ,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAElC;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACJ7J,OAAA;UAAKwJ,SAAS,EAAC,gBAAgB;UAAAC,QAAA,gBAC7BzJ,OAAA;YACE8J,OAAO,EAAEA,CAAA,KAAM3E,qBAAqB,CAAC,IAAI,CAAE;YAC3CqE,SAAS,EAAC,mGAAmG;YAAAC,QAAA,EAC9G;UAED;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACT7J,OAAA;YACE8J,OAAO,EAAEA,CAAA,KAAM3E,qBAAqB,CAAC,KAAK,CAAE;YAC5CqE,SAAS,EAAC,gGAAgG;YAAAC,QAAA,EAC3G;UAED;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV;;EAEA;EACA,IAAIpI,aAAa,KAAK,KAAK,EAAE;IAC3B,oBACEzB,OAAA;MAAKwJ,SAAS,EAAC,gDAAgD;MAAAC,QAAA,gBAC7DzJ,OAAA;QAAGwJ,SAAS,EAAC,cAAc;QAAAC,QAAA,EAAC;MAE5B;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,eACJ7J,OAAA;QACE8J,OAAO,EAAEA,CAAA,KAAMpG,uBAAuB,CAAC,CAAAnC,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEoC,oBAAoB,KAAI,MAAM,CAAE;QACjF6F,SAAS,EAAC,gDAAgD;QAAAC,QAAA,EAC3D;MAED;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;EAEV;;EAEA;EACA,IAAI,CAAClH,eAAe,EAAE;IACpB,oBACE3C,OAAA;MAAKwJ,SAAS,EAAC,8DAA8D;MAAAC,QAAA,eAC3EzJ,OAAA;QAAGwJ,SAAS,EAAC,eAAe;QAAAC,QAAA,EAAC;MAAwB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtD,CAAC;EAEV;EAEA,oBACE7J,OAAA;IAAKwJ,SAAS,EAAE,2BAA2BxI,OAAO,GAAG,KAAK,GAAG,KAAK,wBAAyB;IAAAyI,QAAA,GAExF5H,KAAK,iBACJ7B,OAAA;MAAKwJ,SAAS,EAAC,qDAAqD;MAAAC,QAAA,gBAClEzJ,OAAA;QAAGwJ,SAAS,EAAC,sBAAsB;QAAAC,QAAA,EAAE5H;MAAK;QAAA6H,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC/C7J,OAAA;QACE8J,OAAO,EAAEA,CAAA,KAAMhI,QAAQ,CAAC,IAAI,CAAE;QAC9B0H,SAAS,EAAC,qCAAqC;QAAAC,QAAA,EAChD;MAED;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CACN,EAGA9I,WAAW,iBACVf,OAAA;MAAKwJ,SAAS,EAAC,mDAAmD;MAAAC,QAAA,gBAChEzJ,OAAA;QACE+J,GAAG,EAAE7I,QAAS;QACd8I,QAAQ;QACRC,KAAK;QACLC,WAAW;QACXV,SAAS,EAAE,UAAUxI,OAAO,GAAG,MAAM,GAAG,cAAc;MAAgB;QAAA0I,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvE,CAAC,EAGD9H,SAAS,CAACE,WAAW,iBACpBjC,OAAA;QAAKwJ,SAAS,EAAC,mDAAmD;QAAAC,QAAA,gBAChEzJ,OAAA;UAAMwJ,SAAS,EAAE,wBAAwBzH,SAAS,CAACG,QAAQ,GAAG,eAAe,GAAG,0BAA0B;QAAG;UAAAwH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACrH7J,OAAA;UAAMwJ,SAAS,EAAC,yEAAyE;UAAAC,QAAA,GACtF1H,SAAS,CAACG,QAAQ,GAAG,QAAQ,GAAG,KAAK,EAAC,GAAC,EAACgH,cAAc,CAACnH,SAAS,CAACI,QAAQ,CAAC;QAAA;UAAAuH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CACN,EAGA9H,SAAS,CAACE,WAAW,KAAIV,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEuC,oBAAoB,KACvD/B,SAAS,CAACI,QAAQ,IAAIZ,QAAQ,CAACuC,oBAAoB,GAAG,EAAE,iBACvD9D,OAAA;QAAKwJ,SAAS,EAAC,2EAA2E;QAAAC,QAAA,GACvFlI,QAAQ,CAACuC,oBAAoB,GAAG/B,SAAS,CAACI,QAAQ,EAAC,aACtD;MAAA;QAAAuH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CACN,eAGD7J,OAAA;MAAKwJ,SAAS,EAAC,kDAAkD;MAAAC,QAAA,GAC9D,CAAC1H,SAAS,CAACE,WAAW,IAAI,CAACF,SAAS,CAACK,IAAI,iBACxCpC,OAAA;QACE8J,OAAO,EAAE5G,cAAe;QACxBiH,QAAQ,EAAE,CAAC1I,aAAc;QACzB+H,SAAS,EAAC,oJAAoJ;QAAAC,QAAA,gBAE9JzJ,OAAA;UAAMwJ,SAAS,EAAC;QAA+B;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACvD7J,OAAA;UAAAyJ,QAAA,EAAOzI,OAAO,GAAG,QAAQ,GAAG;QAAiB;UAAA0I,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC/C,CACT,EAEA9H,SAAS,CAACE,WAAW,IAAI,CAACF,SAAS,CAACG,QAAQ,iBAC3ClC,OAAA,CAAAE,SAAA;QAAAuJ,QAAA,gBACEzJ,OAAA;UACE8J,OAAO,EAAE7C,cAAe;UACxBuC,SAAS,EAAC,0GAA0G;UAAAC,QAAA,gBAEpHzJ,OAAA;YAAAyJ,QAAA,EAAM;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACd7J,OAAA;YAAAyJ,QAAA,EAAM;UAAK;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACZ,CAAC,eACT7J,OAAA;UACE8J,OAAO,EAAE/C,aAAc;UACvByC,SAAS,EAAC,sGAAsG;UAAAC,QAAA,gBAEhHzJ,OAAA;YAAAyJ,QAAA,EAAM;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACd7J,OAAA;YAAAyJ,QAAA,EAAM;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACX,CAAC;MAAA,eACT,CACH,EAEA9H,SAAS,CAACE,WAAW,IAAIF,SAAS,CAACG,QAAQ,iBAC1ClC,OAAA,CAAAE,SAAA;QAAAuJ,QAAA,gBACEzJ,OAAA;UACE8J,OAAO,EAAE3C,eAAgB;UACzBqC,SAAS,EAAC,4GAA4G;UAAAC,QAAA,gBAEtHzJ,OAAA;YAAAyJ,QAAA,EAAM;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACd7J,OAAA;YAAAyJ,QAAA,EAAM;UAAM;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACb,CAAC,eACT7J,OAAA;UACE8J,OAAO,EAAE/C,aAAc;UACvByC,SAAS,EAAC,sGAAsG;UAAAC,QAAA,gBAEhHzJ,OAAA;YAAAyJ,QAAA,EAAM;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACd7J,OAAA;YAAAyJ,QAAA,EAAM;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACX,CAAC;MAAA,eACT,CACH,EAEA9H,SAAS,CAACK,IAAI,IAAI,CAACC,WAAW,iBAC7BrC,OAAA,CAAAE,SAAA;QAAAuJ,QAAA,gBACEzJ,OAAA;UACE8J,OAAO,EAAExC,WAAY;UACrBkC,SAAS,EAAC,4GAA4G;UAAAC,QAAA,gBAEtHzJ,OAAA;YAAAyJ,QAAA,EAAM;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACd7J,OAAA;YAAAyJ,QAAA,EAAOzI,OAAO,GAAG,QAAQ,GAAG;UAAc;YAAA0I,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5C,CAAC,eACT7J,OAAA;UACE8J,OAAO,EAAEzC,gBAAiB;UAC1BmC,SAAS,EAAC,yGAAyG;UAAAC,QAAA,gBAEnHzJ,OAAA;YAAAyJ,QAAA,EAAM;UAAE;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACf7J,OAAA;YAAAyJ,QAAA,EAAM;UAAO;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACd,CAAC;MAAA,eACT,CACH,EAEAxH,WAAW,iBACVrC,OAAA;QAAKwJ,SAAS,EAAC,6BAA6B;QAAAC,QAAA,gBAC1CzJ,OAAA;UAAKwJ,SAAS,EAAC,mCAAmC;UAAAC,QAAA,eAChDzJ,OAAA;YACEwJ,SAAS,EAAC,6DAA6D;YACvEY,KAAK,EAAE;cAAEhK,KAAK,EAAE,GAAGmC,cAAc;YAAI;UAAE;YAAAmH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACJ,CAAC,eACN7J,OAAA;UAAMwJ,SAAS,EAAC,uBAAuB;UAAAC,QAAA,GAAElH,cAAc,EAAC,GAAC;QAAA;UAAAmH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7D,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,EAGL9H,SAAS,CAACK,IAAI,IAAI,CAACC,WAAW,iBAC7BrC,OAAA;MAAKwJ,SAAS,EAAC,wCAAwC;MAAAC,QAAA,GAAC,aAC3C,EAACP,cAAc,CAACnH,SAAS,CAACI,QAAQ,CAAC,EAAC,WACzC,EAAC,CAACJ,SAAS,CAACK,IAAI,CAACkE,IAAI,GAAG,IAAI,GAAG,IAAI,EAAE+D,OAAO,CAAC,CAAC,CAAC,EAAC,KACxD;IAAA;MAAAX,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAAC5I,EAAA,CAnjBIX,YAAyC;AAAAgK,EAAA,GAAzChK,YAAyC;AAqjB/C,eAAeA,YAAY;AAAC,IAAAgK,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}