{"ast":null,"code":"const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000/api';\nclass ApiService {\n  getToken() {\n    return localStorage.getItem('token');\n  }\n  getHeaders(includeAuth = true) {\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n    if (includeAuth) {\n      const token = this.getToken();\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n    }\n    return headers;\n  }\n  async handleResponse(response) {\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({\n        detail: 'An error occurred'\n      }));\n      throw new Error(error.detail || error.error || 'Request failed');\n    }\n\n    // Handle empty responses (204 No Content)\n    if (response.status === 204) {\n      return {};\n    }\n    return response.json();\n  }\n\n  // Auth endpoints\n  async login(username, password) {\n    const response = await fetch(`${API_BASE_URL}/token/`, {\n      method: 'POST',\n      headers: this.getHeaders(false),\n      body: JSON.stringify({\n        username,\n        password\n      })\n    });\n    return this.handleResponse(response);\n  }\n  async refreshToken(refresh) {\n    const response = await fetch(`${API_BASE_URL}/token/refresh/`, {\n      method: 'POST',\n      headers: this.getHeaders(false),\n      body: JSON.stringify({\n        refresh\n      })\n    });\n    return this.handleResponse(response);\n  }\n\n  // Generic CRUD methods\n  async get(endpoint) {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'GET',\n      headers: this.getHeaders()\n    });\n    return this.handleResponse(response);\n  }\n  async post(endpoint, data) {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data)\n    });\n    return this.handleResponse(response);\n  }\n  async patch(endpoint, data) {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'PATCH',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data)\n    });\n    return this.handleResponse(response);\n  }\n  async put(endpoint, data) {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'PUT',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data)\n    });\n    return this.handleResponse(response);\n  }\n  async delete(endpoint) {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'DELETE',\n      headers: this.getHeaders()\n    });\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({\n        detail: 'Delete failed'\n      }));\n      throw new Error(error.detail || 'Delete failed');\n    }\n  }\n\n  // File upload\n  async uploadFile(endpoint, formData) {\n    const token = this.getToken();\n    const headers = {};\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'POST',\n      headers,\n      body: formData\n    });\n    return this.handleResponse(response);\n  }\n\n  // Download file\n  async downloadFile(endpoint, filename) {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'GET',\n      headers: this.getHeaders()\n    });\n    if (!response.ok) {\n      throw new Error('Download failed');\n    }\n    const blob = await response.blob();\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    window.URL.revokeObjectURL(url);\n    document.body.removeChild(a);\n  }\n}\nexport const api = new ApiService();\n\n// Typed API endpoints\nexport const endpoints = {\n  // Core\n  currentUser: '/core/me/',\n  users: '/core/users/',\n  fieldResources: '/core/users/field_resources/',\n  availableResources: '/core/users/available_resources/',\n  dashboardStats: '/core/dashboard-stats/',\n  changePassword: '/core/change-password/',\n  organizations: '/core/organizations/',\n  auditLogs: '/core/audit-logs/',\n  // Projects\n  projects: '/projects/',\n  clients: '/projects/clients/',\n  beneficiaries: '/projects/beneficiaries/',\n  projectDocuments: '/projects/documents/',\n  // Questionnaires\n  templates: '/questionnaires/templates/',\n  sections: '/questionnaires/sections/',\n  questions: '/questionnaires/questions/',\n  projectQuestionnaires: '/questionnaires/project-questionnaires/',\n  // Resources\n  assignments: '/resources/assignments/',\n  beneficiaryAssignments: '/resources/beneficiary-assignments/',\n  attendance: '/resources/attendance/',\n  expenses: '/resources/expenses/',\n  // Responses\n  interviews: '/responses/interviews/',\n  answers: '/responses/answers/',\n  media: '/responses/media/',\n  // Analytics\n  reports: '/analytics/reports/',\n  projectAnalytics: id => `/analytics/project/${id}/`,\n  questionAnalytics: (projectId, questionId) => `/analytics/project/${projectId}/question/${questionId}/`,\n  crossTab: id => `/analytics/project/${id}/cross-tab/`,\n  exportData: id => `/analytics/project/${id}/export/`,\n  compareProjects: '/analytics/compare/'\n};\nexport default api;","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","ApiService","getToken","localStorage","getItem","getHeaders","includeAuth","headers","token","handleResponse","response","ok","error","json","catch","detail","Error","status","login","username","password","fetch","method","body","JSON","stringify","refreshToken","refresh","get","endpoint","post","data","patch","put","delete","uploadFile","formData","downloadFile","filename","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","appendChild","click","revokeObjectURL","removeChild","api","endpoints","currentUser","users","fieldResources","availableResources","dashboardStats","changePassword","organizations","auditLogs","projects","clients","beneficiaries","projectDocuments","templates","sections","questions","projectQuestionnaires","assignments","beneficiaryAssignments","attendance","expenses","interviews","answers","media","reports","projectAnalytics","id","questionAnalytics","projectId","questionId","crossTab","exportData","compareProjects"],"sources":["D:/pywork/iams/iams/frontend/src/api/index.ts"],"sourcesContent":["import { AuthTokens, PaginatedResponse } from '../types';\n\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000/api';\n\nclass ApiService {\n  private getToken(): string | null {\n    return localStorage.getItem('token');\n  }\n\n  private getHeaders(includeAuth: boolean = true): HeadersInit {\n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n    };\n\n    if (includeAuth) {\n      const token = this.getToken();\n      if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n      }\n    }\n\n    return headers;\n  }\n\n  private async handleResponse<T>(response: Response): Promise<T> {\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({ detail: 'An error occurred' }));\n      throw new Error(error.detail || error.error || 'Request failed');\n    }\n    \n    // Handle empty responses (204 No Content)\n    if (response.status === 204) {\n      return {} as T;\n    }\n    \n    return response.json();\n  }\n\n  // Auth endpoints\n  async login(username: string, password: string): Promise<AuthTokens> {\n    const response = await fetch(`${API_BASE_URL}/token/`, {\n      method: 'POST',\n      headers: this.getHeaders(false),\n      body: JSON.stringify({ username, password }),\n    });\n    return this.handleResponse<AuthTokens>(response);\n  }\n\n  async refreshToken(refresh: string): Promise<{ access: string }> {\n    const response = await fetch(`${API_BASE_URL}/token/refresh/`, {\n      method: 'POST',\n      headers: this.getHeaders(false),\n      body: JSON.stringify({ refresh }),\n    });\n    return this.handleResponse<{ access: string }>(response);\n  }\n\n  // Generic CRUD methods\n  async get<T>(endpoint: string): Promise<T> {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'GET',\n      headers: this.getHeaders(),\n    });\n    return this.handleResponse<T>(response);\n  }\n\n  async post<T, D = unknown>(endpoint: string, data: D): Promise<T> {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data),\n    });\n    return this.handleResponse<T>(response);\n  }\n\n  async patch<T, D = unknown>(endpoint: string, data: D): Promise<T> {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'PATCH',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data),\n    });\n    return this.handleResponse<T>(response);\n  }\n\n  async put<T, D = unknown>(endpoint: string, data: D): Promise<T> {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'PUT',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data),\n    });\n    return this.handleResponse<T>(response);\n  }\n\n  async delete(endpoint: string): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'DELETE',\n      headers: this.getHeaders(),\n    });\n    \n    if (!response.ok) {\n      const error = await response.json().catch(() => ({ detail: 'Delete failed' }));\n      throw new Error(error.detail || 'Delete failed');\n    }\n  }\n\n  // File upload\n  async uploadFile<T>(endpoint: string, formData: FormData): Promise<T> {\n    const token = this.getToken();\n    const headers: HeadersInit = {};\n    \n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'POST',\n      headers,\n      body: formData,\n    });\n    return this.handleResponse<T>(response);\n  }\n\n  // Download file\n  async downloadFile(endpoint: string, filename: string): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, {\n      method: 'GET',\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Download failed');\n    }\n\n    const blob = await response.blob();\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    window.URL.revokeObjectURL(url);\n    document.body.removeChild(a);\n  }\n}\n\nexport const api = new ApiService();\n\n// Typed API endpoints\nexport const endpoints = {\n  // Core\n  currentUser: '/core/me/',\n  users: '/core/users/',\n  fieldResources: '/core/users/field_resources/',\n  availableResources: '/core/users/available_resources/',\n  dashboardStats: '/core/dashboard-stats/',\n  changePassword: '/core/change-password/',\n  organizations: '/core/organizations/',\n  auditLogs: '/core/audit-logs/',\n\n  // Projects\n  projects: '/projects/',\n  clients: '/projects/clients/',\n  beneficiaries: '/projects/beneficiaries/',\n  projectDocuments: '/projects/documents/',\n  \n  // Questionnaires\n  templates: '/questionnaires/templates/',\n  sections: '/questionnaires/sections/',\n  questions: '/questionnaires/questions/',\n  projectQuestionnaires: '/questionnaires/project-questionnaires/',\n\n  // Resources\n  assignments: '/resources/assignments/',\n  beneficiaryAssignments: '/resources/beneficiary-assignments/',\n  attendance: '/resources/attendance/',\n  expenses: '/resources/expenses/',\n\n  // Responses\n  interviews: '/responses/interviews/',\n  answers: '/responses/answers/',\n  media: '/responses/media/',\n\n  // Analytics\n  reports: '/analytics/reports/',\n  projectAnalytics: (id: number) => `/analytics/project/${id}/`,\n  questionAnalytics: (projectId: number, questionId: number) => \n    `/analytics/project/${projectId}/question/${questionId}/`,\n  crossTab: (id: number) => `/analytics/project/${id}/cross-tab/`,\n  exportData: (id: number) => `/analytics/project/${id}/export/`,\n  compareProjects: '/analytics/compare/',\n};\n\nexport default api;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}